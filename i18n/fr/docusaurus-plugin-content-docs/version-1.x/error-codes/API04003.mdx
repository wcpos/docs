---
title: "API04003 : Réponse JSON Malformée"
sidebar_label: API04003
---

# API04003 : Réponse JSON Malformée

## Ce Que Cela Signifie

Le serveur a renvoyé des données qui semblent être du JSON mais qui sont corrompues ou invalides. Le POS n'a pas pu analyser la réponse car la syntaxe JSON est cassée.

## Causes Courantes

- **Avertissements/notices PHP** — Sortie PHP avant le JSON
- **BOM (Byte Order Mark)** — Caractères invisibles au début du fichier
- **Problèmes d'encodage** — Problèmes d'encodage de caractères
- **Réponse tronquée** — Réponse coupée en cours de transmission
- **Sortie de plugin** — Un plugin a ajouté du contenu non JSON

## Comment Résoudre

### 1. Vérifier les Notices PHP

Les notices/avertissements PHP avant le JSON cassent l'analyse :

Dans `wp-config.php` :
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

Examinez `wp-content/debug.log` et corrigez les problèmes.

### 2. Vérifier les Caractères BOM

Certains éditeurs de texte ajoutent des caractères BOM invisibles :
- Réenregistrez les fichiers PHP sans BOM
- Utilisez l'encodage UTF-8 sans BOM
- Vérifiez les fichiers récemment modifiés

### 3. Vérifier la Réponse Complète

Si les réponses sont tronquées :
- Vérifiez les paramètres de mise en mémoire tampon de sortie PHP
- Augmentez `output_buffering` dans php.ini
- Vérifiez les problèmes de délai d'expiration

### 4. Tester l'API Directement

Dans votre navigateur ou avec curl :
```bash
curl -v https://yoursite.com/wp-json/wcpos/v1/
```

Recherchez tout contenu inattendu avant le JSON.

### 5. Vérifier l'Encodage des Caractères

Assurez-vous que la base de données et PHP utilisent l'UTF-8 :
- Vérifiez les paramètres de jeu de caractères dans `wp-config.php`
- Vérifiez que les tables de base de données sont en UTF-8
- Recherchez les caractères spéciaux causant des problèmes

## Erreurs Connexes

- [API04001](./API04001) — Format de Réponse Invalide
- [API04005](./API04005) — Récupération JSON Tentée