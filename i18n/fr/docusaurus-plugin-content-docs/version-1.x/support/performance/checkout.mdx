---
title: "Performance de la Caisse"
sidebar_label: Performance de la Caisse
sidebar_position: 1
description: Dépanner les temps de caisse lents dans WCPOS en analysant les temps d'exécution et en identifiant les goulets d'étranglement.
---

import Image from "@theme/IdealImage";
import LinkCards from '@site/src/components/LinkCards';
import LinkCard from '@site/src/components/LinkCard';

Si vous rencontrez des performances lentes pendant le processus de caisse, ce guide vous aidera à identifier et à résoudre les causes les plus courantes.

## Comment fonctionne la Caisse WCPOS

La caisse WCPOS ouvre une modal avec un iframe/webview qui charge une version simplifiée du modèle de commande WooCommerce Pay. C'est essentiellement la même page que la [page de paiement client](https://woocommerce.com/document/managing-orders/paying-for-orders/#customer-payment-page-link) que les clients voient lors du paiement des commandes en ligne.

:::info Remarque du Développeur
Vous pouvez voir le modèle de caisse dans le dépôt du plugin WCPOS : [templates/payment.php](https://github.com/wcpos/woocommerce-pos/blob/main/templates/payment.php)
:::

## Optimisations intégrées

WCPOS inclut plusieurs optimisations pour améliorer les performances de la caisse :

- **Modèle simplifié** - Supprime les éléments de thème inutiles et l'encombrement
- **Chargement sélectif de scripts/styles** - Seuls les scripts et styles essentiels sont chargés
- **Structure DOM minimale** - Réduit la complexité de la page de caisse

Cependant, certains scripts et styles ne peuvent pas être complètement désactivés car les passerelles de paiement peuvent en avoir besoin pour fonctionner correctement.

## Problèmes de performance courants

### 1. Scripts et Styles Inutiles

**Problème :** Les thèmes et les plugins ajoutent des scripts et des styles qui ne sont pas nécessaires pour la caisse, ralentissant les temps de chargement des pages.

**Solution :** Utilisez les [Paramètres de Caisse](/pos/checkout#checkout-settings-troubleshooting) pour désactiver les ressources inutiles :

1. Cliquez sur le bouton **Paramètres de Caisse** dans la modal de caisse
2. Essayez de désactiver d'abord les styles du thème :
   - wp-block-library
   - classic-theme-styles
   - Styles personnalisés de votre thème
3. Désactivez les scripts WooCommerce non essentiels :
   - wc-add-to-cart
   - selectWoo (si non nécessaire pour votre passerelle)
   - html5shiv

<div class="image-container">
  <Image
    alt="Formulaire pour désactiver tous les styles et scripts"
    img="/img/disable-styles-and-scripts.png"
    style={{ maxHeight: 600 }}
  />
  <p class="image-caption">Formulaire pour désactiver tous les styles et scripts</p>
</div>

:::warning Soyez prudent
Ne désactivez pas les scripts dont votre passerelle de paiement a besoin. Si une méthode de paiement cesse de fonctionner après avoir désactivé un script, réactivez-le.
:::

### 2. Interférence des Plugins lors de la Création de Commandes

**Problème :** Les plugins qui s'intègrent dans le processus de création de commandes peuvent causer des retards significatifs. Par exemple, les plugins de comptabilité comme Xero peuvent envoyer des données de commande à des serveurs externes, bloquant le processus de caisse.

**Étapes de Dépannage :**

1. **Testez sur staging** - Si vous avez un serveur de staging, désactivez tous les plugins sauf WooCommerce et WCPOS
2. **Testez la vitesse de la caisse** - Traitez une commande test et notez les performances
3. **Activez les plugins progressivement** - Si les performances s'améliorent de manière significative, réactivez les plugins un par un pour identifier le coupable
4. **Contactez les développeurs de plugins** - Si un plugin spécifique cause des problèmes, contactez le développeur pour des conseils d'optimisation

**Types de plugins problématiques courants :**
- Intégrations de comptabilité/tenue de livres (Xero, QuickBooks)
- Outils de marketing par e-mail déclenchés lors de la création de commandes
- Systèmes de gestion des stocks
- Calculatrices d'expédition complexes
- Outils d'analyse tiers

### 3. Limitations des Ressources Serveur

**Problème :** Si votre serveur est sous charge ou manque de ressources suffisantes, toutes les opérations, y compris la caisse, seront lentes.

**Surveillance et Solutions :**

1. **Surveillez la performance du serveur :**
   - Utilisation du CPU pendant la caisse
   - Consommation de mémoire
   - Performance des requêtes de base de données
   - Latence réseau

2. **Optimisez les ressources serveur :**
   - Augmentez la limite de mémoire PHP
   - Optimisez les requêtes de base de données
   - Utilisez des plugins de mise en cache (mais testez la compatibilité)
   - Envisagez d'augmenter votre plan d'hébergement

3. **Optimisation de la base de données :**
   - Nettoyez les anciennes données de commande
   - Optimisez les tables de la base de données
   - Supprimez les plugins et thèmes inutiles

## Meilleures Pratiques pour Développeurs WordPress

:::tip Pour les Développeurs
Les développeurs WordPress devraient utiliser `wp_enqueue_scripts` pour ajouter correctement les scripts et styles aux pages. Malheureusement, certains développeurs de plugins et de thèmes ne suivent pas les meilleures pratiques et insèrent du code directement dans les modèles, rendant impossible la désactivation de ces ressources facilement.
:::

Si vous rencontrez des problèmes avec des scripts ou des styles qui ne peuvent pas être désactivés via les Paramètres de Caisse :

1. **Contactez le développeur** - Demandez-leur de suivre les normes de codage WordPress
2. **Utilisez des thèmes enfants** - Remplacez les modèles problématiques dans un thème enfant
3. **Hooks personnalisés** - Utilisez des hooks WordPress pour supprimer le code problématique sur les pages de caisse

## Test de Performance

Pour tester les améliorations de la performance de la caisse :

1. **Mesure de base** - Chronométrez combien de temps prend la caisse avant de faire des changements
2. **Faites un changement à la fois** - Cela aide à identifier quels changements ont le plus d'impact
3. **Testez avec de vraies passerelles de paiement** - Ne testez pas seulement avec des paiements en espèces
4. **Testez sur différents appareils** - Les appareils mobiles peuvent montrer différentes caractéristiques de performance

## Gains Rapides

Voici les améliorations de performance les plus efficaces que vous pouvez apporter :

1. **Désactivez les styles de thème** - Fournit souvent la plus grande amélioration
2. **Supprimez les scripts WooCommerce inutiles** - Réduit le temps d'exécution de JavaScript
3. **Audit des hooks de création de commande** - Identifiez et optimisez les plugins lents
4. **Optimisez les images** - Assurez-vous que toutes les images dans la caisse sont optimisées
5. **Utilisez un plugin de surveillance de performance** - Suivez les améliorations au fil du temps

## Quand Demander de l'Aide

Contactez le support WCPOS si :

- La caisse prend plus de 10 secondes de manière constante
- Vous avez suivi ce guide mais rencontrez toujours des problèmes
- Vous suspectez un plugin spécifique mais ne pouvez pas l'identifier
- Vous avez besoin d'aide pour optimiser les ressources du serveur

## Documentation Connexe

<LinkCards>
  <LinkCard to="/pos/checkout#checkout-settings-troubleshooting" title="Paramètres de Caisse" description="Désactivez les scripts et styles problématiques" />
  <LinkCard to="/payment" title="Méthodes de Paiement" description="Configurez les passerelles de paiement pour des performances optimales" />
  <LinkCard to="/category/troubleshooting" title="Dépannage" description="Guides de dépannage généraux" />
</LinkCards>