---
title: "API04003: استجابة JSON تالفة"
sidebar_label: API04003
---

# API04003: استجابة JSON تالفة

## ما يعنيه هذا

أرسل الخادم بيانات تشبه JSON ولكنها تالفة أو غير صالحة. تعذر على نظام نقطة البيع تحليل الاستجابة بسبب كسر بنية JSON.

## الأسباب الشائعة

- **إشعارات/تحذيرات PHP** — PHP يخرج محتوى قبل JSON
- **علامة ترتيب البايت (BOM)** — حروف غير مرئية في بداية الملف
- **مشاكل الترميز** — مشاكل في ترميز الأحرف
- **استجابة مقطوعة** — الاستجابة مقطوعة أثناء الإرسال
- **إخراج المُكونات الإضافية** — مكون إضافي أضاف محتوى غير JSON

## كيفية الإصلاح

### 1. التحقق من إشعارات PHP

الإشعارات/التحذيرات قبل JSON تكسر التحليل:

في `wp-config.php`:
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

راجع `wp-content/debug.log` وأصلح أي مشاكل.

### 2. التحقق من حروف BOM

بعض محررات النصوص تضيف حروف BOM غير مرئية:
- أعد حفظ ملفات PHP بدون BOM
- استخدم UTF-8 بدون ترميز BOM
- تحقق من الملفات المحررة مؤخرًا

### 3. التأكد من اكتمال الاستجابة

إذا كانت الاستجابات مقطوعة:
- تحقق من إعدادات التخزين المؤقت للإخراج PHP
- زد قيمة `output_buffering` في php.ini
- تحقق من مشاكل انتهاء المهلة

### 4. اختبار API مباشرة

في المتصفح أو باستخدام curl:
```bash
curl -v https://yoursite.com/wp-json/wcpos/v1/
```

ابحث عن أي محتوى غير متوقع قبل JSON.

### 5. التحقق من ترميز الأحرف

تأكد من استخدام UTF-8 في قاعدة البيانات و PHP:
- تحقق من إعدادات ترميز الأحرف في `wp-config.php`
- تأكد من أن جداول قاعدة البيانات بترميز UTF-8
- ابحث عن الأحرف الخاصة التي تسبب مشاكل

## أخطاء ذات صلة

- [API04001](./API04001) — تنسيق استجابة غير صالح
- [API04005](./API04005) — محاولة استرداد JSON