---
title: أداء عملية الخروج
sidebar_label: أداء عملية الخروج
sidebar_position: 1
---

import Image from "@theme/IdealImage";

إذا كنت تواجه أداءً بطيئًا خلال عملية الخروج، سيساعدك هذا الدليل في تحديد وحل أكثر الأسباب شيوعًا.

## كيف يعمل الخروج في WCPOS

يفتح الخروج في WCPOS نافذة مودال تحتوي على iframe/webview لتحميل نسخة مبسطة من قالب WooCommerce Order Pay. هذه هي في الأساس نفس الصفحة التي يراها العملاء عند الدفع للطلبات عبر الإنترنت [صفحة دفع العملاء](https://woocommerce.com/document/managing-orders/paying-for-orders/#customer-payment-page-link).

:::info ملاحظة المطور
يمكنك عرض قالب الخروج في مستودع مكونات WCPOS: [templates/payment.php](https://github.com/wcpos/woocommerce-pos/blob/main/templates/payment.php)
:::

## تحسينات مدمجة

يتضمن WCPOS عدة تحسينات لتحسين أداء الخروج:

- **قالب مبسّط** - يزيل العناصر والطابع غير الضروري للثيمات والفوضى
- **تحميل انتقائي للسكربتات/الأنماط** - يتم تحميل السكربتات والأنماط الأساسية فقط
- **هيكل DOM مبسّط** - يقلل من تعقيد صفحة الخروج

ومع ذلك، لا يمكن تعطيل بعض السكربتات والأنماط نهائيًا لأن بوابات الدفع قد تتطلبها للعمل بشكل صحيح.

## مشكلات الأداء الشائعة

### 1. السكربتات والأنماط غير الضرورية

**المشكلة:** تضيف الثيمات والمكونات الإضافية سكربتات وأنماطًا غير ضرورية للخروج، مما يؤدي إلى بطء تحميل الصفحة.

**الحل:** استخدم [إعدادات الخروج](/pos/checkout#checkout-settings-troubleshooting) لتعطيل الموارد غير الضرورية:

1. انقر على زر **إعدادات الخروج** في نافذة المودال الخاصة بالخروج
2. حاول تعطيل أنماط الثيمة أولاً:
   - wp-block-library
   - classic-theme-styles
   - أنماط الثيمة المخصصة الخاصة بك
3. قم بتعطيل السكربتات غير الأساسية لـ WooCommerce:
   - wc-add-to-cart
   - selectWoo (إذا لم تكن مطلوبة من قبل بوابتك)
   - html5shiv

<div class="image-container">
  <Image
    alt="نموذج لتعطيل جميع الأنماط والسكربتات"
    img="/img/disable-styles-and-scripts.png"
    style={{ maxHeight: 600 }}
  />
  <p class="image-caption">نموذج لتعطيل جميع الأنماط والسكربتات</p>
</div>

:::warning احترس
لا تعطل السكربتات التي تتطلبها بوابة الدفع الخاصة بك. إذا توقفت طريقة الدفع عن العمل بعد تعطيل سكربت، قم بإعادة تفعيله.
:::

### 2. تدخل الملحقات أثناء إنشاء الطلب

**المشكلة:** قد تؤدي الملحقات التي ترتبط بعملية إنشاء الطلب إلى تأخيرات كبيرة. على سبيل المثال، قد ترسل ملحقات المحاسبة مثل Xero بيانات الطلب إلى خوادم خارجية، مما يعيق عملية الخروج.

**خطوات استكشاف الأخطاء:**

1. **اختبر على بيئة الاختبار** - إذا كان لديك خادم اختبار، قم بتعطيل جميع الملحقات باستثناء WooCommerce وWCPOS
2. **اختبر سرعة الخروج** - قم بمعالجة طلب اختبار وراقب الأداء
3. **قم بتمكين الملحقات تدريجيًا** - إذا تحسن الأداء بشكل كبير، أعد تفعيل الملحقات واحدة تلو الأخرى لتحديد السبب
4. **اتصل بمطوري الملحقات** - إذا كان ملحق معين يسبب مشكلات، اتصل بالمطور للحصول على نصيحة بشأن التحسين

**أنواع الملحقات الشائعة المسببة للمشكلات:**
- تكاملات المحاسبة/المحاسبة (Xero، QuickBooks)
- أدوات التسويق عبر البريد الإلكتروني التي تنطلق عند إنشاء الطلب
- أنظمة إدارة المخزون
- حاسبات الشحن المعقدة
- أدوات التحليل من طرف ثالث

### 3. قيود موارد الخادم

**المشكلة:** إذا كان خادمك تحت الحمل أو يفتقر إلى الموارد الكافية، ستصبح جميع العمليات بما في ذلك الخروج بطيئة.

**المراقبة والحلول:**

1. **راقب أداء الخادم:**
   - استخدام وحدة المعالجة المركزية خلال الخروج
   - استهلاك الذاكرة
   - أداء استعلامات قاعدة البيانات
   - تأخر الشبكة

2. **حسن موارد الخادم:**
   - زيادة حد الذاكرة PHP
   - تحسين استعلامات قاعدة البيانات
   - استخدام ملحقات التخزين المؤقت (لكن اختبر التوافق)
   - النظر في ترقية خطة الاستضافة

3. **تحسين قاعدة البيانات:**
   - تنظيف بيانات الطلبات القديمة
   - تحسين جداول قاعدة البيانات
   - إزالة الملحقات والثيمات غير الضرورية

## أفضل الممارسات لمطوري WordPress

:::tip للمطورين
يجب على مطوري WordPress استخدام `wp_enqueue_scripts` لإضافة السكربتات والأنماط بشكل صحيح إلى الصفحات. ولكن للأسف، لا يتبع بعض مطوري الثيمات والملحقات أفضل الممارسات ويقومون بإدراج الكود مباشرةً في القوالب، مما يجعل من المستحيل إلغاء تحميل هذه الموارد بسهولة.
:::

إذا كنت تواجه مشكلات مع السكربتات أو الأنماط التي لا يمكن تعطيلها من خلال إعدادات الخروج:

1. **اتصل بالمطور** - اطلب منهم اتباع معايير الترميز الخاصة بـ WordPress
2. **استخدم الثيمات الفرعية** - override القوالب المسببة للمشاكل في ثيم فرعي
3. **خطاطيف مخصصة** - استخدم خطاطيف WordPress لإزالة الكود المسبب للمشاكل على صفحات الخروج

## اختبار الأداء

لاختبار تحسينات أداء الخروج:

1. **قياس خط الأساس** - قياس الوقت الذي يستغرقه الخروج قبل إجراء تغييرات
2. **قم بإجراء تغيير واحد في كل مرة** - يساعد هذا في تحديد أي التغييرات لها التأثير الأكبر
3. **اختبر مع بوابات الدفع الحقيقية** - لا تختبر فقط مع المدفوعات النقدية
4. **اختبر على أجهزة مختلفة** - قد تظهر الأجهزة المحمولة خصائص أداء مختلفة

## انتصارات سريعة

إليك أكثر تحسينات الأداء فاعلية التي يمكنك القيام بها:

1. **تعطيل أنماط الثيمة** - غالبًا ما يوفر أكبر تحسين
2. **إزالة السكربتات غير الضرورية لـ WooCommerce** - تقلل من وقت تنفيذ JavaScript
3. **تدقيق خطاطيف إنشاء الطلب** - تحديد وتحسين الملحقات البطيئة
4. **تحسين الصور** - تأكد من تحسين أي صور في عملية الخروج
5. **استخدم ملحق مراقبة الأداء** - تتبع التحسينات بمرور الوقت

## متى تطلب المساعدة

اتصل بدعم WCPOS إذا:

- استغرق الخروج أكثر من 10 ثوانٍ بشكل مستمر
- لقد اتبعت هذا الدليل لكن لا تزال تواجه مشاكل
- تشك في ملحق معين لكن لا يمكنك تحديده
- تحتاج إلى مساعدة في تحسين موارد الخادم

## الوثائق ذات الصلة

- [إعدادات الخروج](/pos/checkout#checkout-settings-troubleshooting) - تعطيل السكربتات والأنماط المسببة للمشاكل
- [طرق الدفع](/payment) - تكوين بوابات الدفع لتحقيق الأداء الأمثل
- [استكشاف الأخطاء](/category/troubleshooting) - أدلة استكشاف الأخطاء العامة

---