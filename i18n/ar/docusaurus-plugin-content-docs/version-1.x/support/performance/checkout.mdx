---
title: أداء عملية الدفع
sidebar_label: أداء عملية الدفع
sidebar_position: 1
---

import Image from "@theme/IdealImage";

إذا كنت تواجه أداءً بطيئًا أثناء عملية الدفع، ستساعدك هذه الإرشادات في تحديد وحل الأسباب الأكثر شيوعًا.

## كيفية عمل الدفع في WCPOS

يفتح الدفع في WCPOS نافذة مودال مع iframe/webview تحمل نسخة مبسطة من قالب دفع الطلبات في WooCommerce. هذه الصفحة هي في الأساس نفس صفحة [صفحة دفع العميل](https://woocommerce.com/document/managing-orders/paying-for-orders/#customer-payment-page-link) التي يراها العملاء عند الدفع للطلبات عبر الإنترنت.

:::info ملاحظة المطور
يمكنك عرض قالب الدفع في مستودع إضافة WCPOS: [templates/payment.php](https://github.com/wcpos/woocommerce-pos/blob/main/templates/payment.php)
:::

## تحسينات مدمجة

يتضمن WCPOS عدة تحسينات لتحسين أداء عملية الدفع:

- **قالب مبسط** - يزيل العناصر غير الضرورية من المظهر والفوضى
- **تحميل انتقائي للسكريبتات والأساليب** - يتم تحميل السكريبتات والأساليب الأساسية فقط
- **هيكل DOM بسيط** - يقلل من تعقيد صفحة الدفع

ومع ذلك، لا يمكن تعطيل بعض السكريبتات والأساليب تمامًا لأن بوابات الدفع قد تتطلبها للعمل بشكل صحيح.

## مشكلات شائعة في الأداء

### 1. السكريبتات والأساليب غير الضرورية

**المشكلة:** تضيف المظاهر والإضافات سكريبتات وأساليب ليست ضرورية لعملية الدفع، مما يؤدي إلى إبطاء أوقات تحميل الصفحات.

**الحل:** استخدم [إعدادات الدفع](/pos/checkout#checkout-settings-troubleshooting) لتعطيل الموارد غير الضرورية:

1. انقر على زر **إعدادات الدفع** في نافذة الدفع
2. حاول تعطيل أنماط المظهر أولاً:
   - wp-block-library
   - classic-theme-styles
   - الأنماط المخصصة لمظهرك
3. قم بتعطيل السكريبتات غير الأساسية لـ WooCommerce:
   - wc-add-to-cart
   - selectWoo (إذا لم تكن مطلوبة من قبل بوابتك)
   - html5shiv

<div class="image-container">
  <Image
    alt="نموذج لتعطيل جميع الأنماط والسكريبتات"
    img="/img/disable-styles-and-scripts.png"
    style={{ maxHeight: 600 }}
  />
  <p class="image-caption">نموذج لتعطيل جميع الأنماط والسكريبتات</p>
</div>

:::warning كن حذرًا
لا تعطل السكريبتات التي تتطلبها بوابة الدفع الخاصة بك. إذا توقفت طريقة الدفع عن العمل بعد تعطيل سكريبت، قم بإعادة تمكينه.
:::

### 2. تدخل الإضافات أثناء إنشاء الطلب

**المشكلة:** يمكن أن تؤدي الإضافات التي تتفاعل مع عملية إنشاء الطلب إلى تأخيرات كبيرة. على سبيل المثال، قد ترسل إضافات المحاسبة مثل Xero بيانات الطلب إلى خوادم خارجية، مما يمنع عملية الدفع.

**خطوات معالجة المشكلة:**

1. **اختبار على بيئة اختبار** - إذا كان لديك خادم اختبار، قم بتعطيل جميع الإضافات باستثناء WooCommerce و WCPOS
2. **اختبار سرعة عملية الدفع** - قم بمعالجة طلب اختبار ولاحظ الأداء
3. **تفعيل الإضافات تدريجيًا** - إذا تحسن الأداء بشكل كبير، قم بإعادة تفعيل الإضافات واحدة تلو الأخرى لتحديد الجاني
4. **الاتصال بمطوري الإضافات** - إذا كانت إضافة معينة تسبب مشكلات، اتصل بالمطور للحصول على نصائح تحسين

**أنواع الإضافات الشائعة التي تسبب مشكلات:**
- تكاملات المحاسبة (Xero، QuickBooks)
- أدوات التسويق عبر البريد الإلكتروني التي تت-trigger عند إنشاء الطلب
- أنظمة إدارة المخزون
- آلات حساب الشحن المعقدة
- أدوات التحليل التابعة لجهات خارجية

### 3. قيود موارد الخادم

**المشكلة:** إذا كان خادمك تحت ضغط أو يفتقر إلى الموارد الكافية، فإن جميع العمليات بما في ذلك الدفع ستكون بطيئة.

**رصد وحلول:**

1. **راقب أداء الخادم:**
   - استخدام وحدة المعالجة المركزية أثناء عملية الدفع
   - استهلاك الذاكرة
   - أداء استعلامات قاعدة البيانات
   - زمن الانتقال في الشبكة

2. **تحسين موارد الخادم:**
   - زيادة حد الذاكرة في PHP
   - تحسين استعلامات قاعدة البيانات
   - استخدام إضافات التخزين المؤقت (لكن تحقق من التوافق)
   - النظر في ترقية خطة الاستضافة

3. **تحسين قاعدة البيانات:**
   - تنظيف بيانات الطلبات القديمة
   - تحسين جداول قاعدة البيانات
   - إزالة الإضافات والمظاهر غير الضرورية

## أفضل ممارسات مطور WordPress

:::tip للمطورين
يجب على مطوري WordPress استخدام `wp_enqueue_scripts` لإضافة السكريبتات والأساليب بشكل صحيح إلى الصفحات. للأسف، لا يتبع بعض مطوري الإضافات والمظاهر أفضل الممارسات ويقومون بإدراج كود مباشرة في القوالب، مما يجعل من المستحيل إلغاء هذه الموارد بسهولة.
:::

إذا كنت تواجه مشكلات مع السكريبتات أو الأساليب التي لا يمكن تعطيلها من خلال إعدادات الدفع:

1. **الاتصال بالمطور** - اطلب منه اتباع معايير الترميز الخاصة بـ WordPress
2. **استخدم السمات الفرعية** - قم بتجاوز القوالب المشكلة في سمة فرعية
3. **خطافات مخصصة** - استخدم خطافات WordPress لإزالة الكود المشكلة في صفحات الدفع

## اختبار الأداء

لاختبار تحسينات أداء عملية الدفع:

1. **قياس خط الأساس** - الوقت المستغرق لعملية الدفع قبل إجراء التغييرات
2. **قم بإجراء تغيير واحد في المرة** - يساعد ذلك في تحديد أي تغييرات لها أكبر تأثير
3. **اختبار مع بوابات الدفع الحقيقية** - لا تختبر فقط مع المدفوعات النقدية
4. **اختبار على أجهزة مختلفة** - قد تظهر الأجهزة المحمولة خصائص أداء مختلفة

## انتصارات سريعة

إليك أكثر تحسينات الأداء فعالية التي يمكنك القيام بها:

1. **تعطيل أنماط المظهر** - غالبًا ما يوفر أكبر تحسين
2. **إزالة السكريبتات غير الضرورية لـ WooCommerce** - يقلل من وقت تنفيذ JavaScript
3. **مراجعة خطافات إنشاء الطلب** - تحديد وتحسين الإضافات البطيئة
4. **تحسين الصور** - تأكد من تحسين أي صور في عملية الدفع
5. **استخدام إضافة لمراقبة الأداء** - تتبع التحسينات بمرور الوقت

## متى تطلب المساعدة

اتصل بدعم WCPOS إذا:

- استغرقت عملية الدفع أكثر من 10 ثوانٍ باستمرار
- اتبعت هذه الإرشادات لكن لا تزال تواجه مشكلات
- تشك في إضافة معينة لكن لا يمكنك تحديدها
- تحتاج إلى مساعدة في تحسين موارد الخادم

## الوثائق ذات الصلة

- [إعدادات الدفع](/pos/checkout#checkout-settings-troubleshooting) - تعطيل السكريبتات والأساليب المشكلة
- [طرق الدفع](/payment) - تكوين بوابات الدفع لتحقيق الأداء الأمثل
- [استكشاف الأخطاء](/category/troubleshooting) - أدلة استكشاف الأخطاء العامة