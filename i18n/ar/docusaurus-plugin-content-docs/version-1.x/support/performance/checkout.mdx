---
title: أداء عملية الدفع
sidebar_label: أداء عملية الدفع
sidebar_position: 1
description: استكشاف المشكلة في أوقات الدفع البطيئة في WCPOS من خلال تحليل أوقات التنفيذ وتحديد الاختناقات.
---

import Image from "@theme/IdealImage";
import LinkCards from '@site/src/components/LinkCards';
import LinkCard from '@site/src/components/LinkCard';

إذا كنت تعاني من أداء بطيء أثناء عملية الدفع، سيساعدك هذا الدليل في تحديد وحل الأسباب الأكثر شيوعًا.

## كيفية عمل عملية الدفع في WCPOS

تفتح عملية الدفع في WCPOS نافذة عائمة تحتوي على iframe/webview التي تحمل نسخة مبسطة من قالب الدفع الخاص ب WooCommerce. هذه في الأساس هي نفس الصفحة التي يشاهدها العملاء عند الدفع للطلبات عبر الإنترنت.

:::info ملاحظة المطور
يمكنك عرض قالب الدفع في مستودع إضافة WCPOS: [templates/payment.php](https://github.com/wcpos/woocommerce-pos/blob/main/templates/payment.php)
:::

## تحسينات مدمجة

يتضمن WCPOS عدة تحسينات لتحسين أداء عملية الدفع:

- **قالب مبسط** - يزيل العناصر غير الضرورية من السمة والفوضى
- **تحميل نصوص/أنماط انتقائي** - يتم تحميل النصوص والأنماط الأساسية فقط
- **هيكل DOM بسيط** - يقلل من تعقيد صفحة الدفع

ومع ذلك، لا يمكن تعطيل بعض النصوص والأنماط تمامًا لأن بوابات الدفع قد تتطلبها للعمل بشكل صحيح.

## مشاكل الأداء الشائعة

### 1. نصوص وأنماط غير ضرورية

**المشكلة:** تضيف السمات والإضافات نصوصًا وأنماطًا ليست بحاجة إليها لعملية الدفع، مما يبطئ أوقات تحميل الصفحة.

**الحل:** استخدم [إعدادات الدفع](/pos/checkout#checkout-settings-troubleshooting) لتعطيل الموارد غير الضرورية:

1. انقر على زر **إعدادات الدفع** في نافذة الدفع
2. حاول تعطيل أنماط السمة أولاً:
   - wp-block-library
   - classic-theme-styles
   - أنماط السمة المخصصة
3. عطِّل النصوص غير الأساسية ل WooCommerce:
   - wc-add-to-cart
   - selectWoo (إذا لم تكن مطلوبة من قبل بوابتك)
   - html5shiv

<div class="image-container">
  <Image
    alt="نموذج لتعطيل جميع الأنماط والنصوص"
    img="/img/disable-styles-and-scripts.png"
    style={{ maxHeight: 600 }}
  />
  <p class="image-caption">نموذج لتعطيل جميع الأنماط والنصوص</p>
</div>

:::warning كن حذرًا
لا تقم بتعطيل النصوص التي تتطلبها بوابة الدفع الخاصة بك. إذا توقفت إحدى طرق الدفع عن العمل بعد تعطيل نص، أعد تمكينه.
:::

### 2. تداخل الإضافات أثناء إنشاء الطلب

**المشكلة:** يمكن أن تتسبب الإضافات التي تتعلق بعملية إنشاء الطلب في تأخيرات كبيرة. على سبيل المثال، قد تقوم إضافات المحاسبة مثل ثيرو بإرسال بيانات الطلب إلى خوادم خارجية، مما يعيق عملية الدفع.

**خطوات استكشاف الأخطاء:**

1. **اختبار على الخادم التجريبي** - إذا كان لديك خادم تجريبي، قم بتعطيل جميع الإضافات باستثناء WooCommerce و WCPOS
2. **اختبار سرعة الدفع** - قم بمعالجة طلب تجريبي ولاحظ الأداء
3. **تمكين الإضافات تدريجياً** - إذا تحسن الأداء بشكل كبير، أعد تمكين الإضافات واحدة تلو الأخرى لتحديد الجاني
4. **الاتصال بالمطورين الإضافات** - إذا كان أحد الإضافات المحددة تسبب مشكلات، اتصل بالمطور للحصول على نصائح التحسين

**أنواع الإضافات المشكلة الشائعة:**
- تكاملات المحاسبة/المحاسبة (ثيرو، كويك بوك)
- أدوات التسويق عبر البريد الإلكتروني التي تعمل عند إنشاء الطلب
- أنظمة إدارة المخزون
- حاسبات الشحن المعقدة
- أدوات التحليل من طرف ثالث

### 3. قيود موارد الخادم

**المشكلة:** إذا كان الخادم الخاص بك تحت ضغط أو يفتقر إلى الموارد الكافية، ستصبح جميع العمليات بما في ذلك الدفع بطيئة.

**المراقبة والحلول:**

1. **مراقبة أداء الخادم:**
   - استخدام وحدة المعالجة المركزية أثناء الدفع
   - استهلاك الذاكرة
   - أداء استعلامات قاعدة البيانات
   - زمن الوصول الشبكي

2. **تحسين موارد الخادم:**
   - زيادة حد الذاكرة PHP
   - تحسين استعلامات قاعدة البيانات
   - استخدام إضافات التخزين المؤقت (لكن اختبر التوافق)
   - التفكير في ترقية خطة الاستضافة

3. **تحسين قاعدة البيانات:**
   - تنظيف بيانات الطلبات القديمة
   - تحسين جداول قاعدة البيانات
   - إزالة الإضافات والسمات غير الضرورية

## أفضل الممارسات لمطوري WordPress

:::tip للمطورين
يجب على مطوري WordPress استخدام `wp_enqueue_scripts` لإضافة النصوص والأنماط بشكل صحيح إلى الصفحات. وللأسف، لا يتبع بعض مطوري الإضافات والسمات أفضل الممارسات ويقومون بإدراج التعليمات البرمجية مباشرة في القوالب، مما يجعل من المستحيل حذف هذه الموارد بسهولة.
:::

إذا كنت تعاني من مشكلات مع نصوص أو أنماط لا يمكن تعطيلها من خلال إعدادات الدفع:

1. **الاتصال بالمطور** - اطلب منهم اتباع معايير البرمجة الخاصة ب WordPress
2. **استخدام السمات الفرعية** - تجاوز القوالب المسببة للمشاكل في سمة فرعية
3. **خطاطيف مخصصة** - استخدم خطاطيف WordPress لإزالة التعليمات البرمجية المشكلة في صفحات الدفع

## اختبار الأداء

لاختبار تحسينات أداء الدفع:

1. **قياس خط الأساس** - احسب المدة التي تستغرقها عملية الدفع قبل إجراء التغييرات
2. **قم بإجراء تغيير واحد في الوقت** - يساعد ذلك في تحديد التغييرات التي لها أكبر تأثير
3. **اختبر مع بوابات الدفع الحقيقية** - لا تختبر فقط مع المدفوعات النقدية
4. **اختبر على أجهزة مختلفة** - قد تظهر الأجهزة المحمولة خصائص أداء مختلفة

## انتصارات سريعة

إليك أبرز تحسينات الأداء التي يمكنك إجراؤها:

1. **تعطيل أنماط السمة** - غالبًا ما يوفر أكبر تحسين
2. **إزالة نصوص WooCommerce غير الضرورية** - يقلل من وقت تنفيذ JavaScript
3. **تدقيق خطوط إنشاء الطلب** - تحديد وتحسين الإضافات البطيئة
4. **تحسين الصور** - تأكد من تحسين أي صور في عملية الدفع
5. **استخدام إضافة لمراقبة الأداء** - تتبع التحسينات على مر الزمن

## متى تطلب المساعدة

اتصل بدعم WCPOS إذا:

- تستغرق عملية الدفع أكثر من 10 ثوانٍ بشكل مستمر
- لقد اتبعت هذا الدليل ولكن لا تزال تواجه مشكلات
- تشك في إضافة محددة ولكن لا يمكنك تحديدها
- تحتاج إلى المساعدة في تحسين موارد الخادم

## الوثائق ذات الصلة

<LinkCards>
  <LinkCard to="/pos/checkout#checkout-settings-troubleshooting" title="إعدادات الدفع" description="تعطيل النصوص والأنماط المشكلات" />
  <LinkCard to="/payment" title="طرق الدفع" description="تكوين بوابات الدفع للأداء الأمثل" />
  <LinkCard to="/category/troubleshooting" title="استكشاف الأخطاء" description="أدلة الاستكشاف العامة" />
</LinkCards>