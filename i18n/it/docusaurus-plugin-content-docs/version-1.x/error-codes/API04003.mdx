---
title: "API04003: Risposta JSON Malformata"
sidebar_label: API04003
---

# API04003: Risposta JSON Malformata

## Cosa Significa

Il server ha restituito dati che sembrano essere JSON ma sono corrotti o non validi. Il POS non è riuscito a elaborare la risposta perché la sintassi JSON è danneggiata.

## Cause Comuni

- **Avvisi/Notifiche PHP** — Output PHP prima del JSON
- **BOM (Byte Order Mark)** — Caratteri invisibili all'inizio del file
- **Problemi di codifica** — Problemi di codifica dei caratteri
- **Risposta troncata** — Risposta interrotta a metà trasmissione
- **Output del plugin** — Un plugin ha aggiunto contenuto non JSON

## Come Risolvere

### 1. Controllare le Notifiche PHP

Le notifiche/avvisi PHP prima del JSON interrompono l'elaborazione:

In `wp-config.php`:
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

Esaminare `wp-content/debug.log` e risolvere eventuali problemi.

### 2. Controllare i Caratteri BOM

Alcuni editor di testo aggiungono caratteri BOM invisibili:
- Salvare nuovamente i file PHP senza BOM
- Utilizzare la codifica UTF-8 senza BOM
- Controllare i file modificati di recente

### 3. Verificare la Risposta Completa

Se le risposte vengono troncate:
- Controllare le impostazioni del buffer di output PHP
- Aumentare `output_buffering` in php.ini
- Verificare eventuali problemi di timeout

### 4. Testare l'API Direttamente

Nel browser o usando curl:
```bash
curl -v https://yoursite.com/wp-json/wcpos/v1/
```

Cercare eventuali contenuti inattesi prima del JSON.

### 5. Controllare la Codifica dei Caratteri

Assicurarsi che database e PHP utilizzino UTF-8:
- Controllare le impostazioni del charset in `wp-config.php`
- Verificare che le tabelle del database siano UTF-8
- Cercare caratteri speciali che causano problemi

## Errori Correlati

- [API04001](./API04001) — Formato Risposta Non Valido
- [API04005](./API04005) — Tentativo di Recupero JSON