---
title: "API04003: Respuesta JSON Mal Formada"
sidebar_label: API04003
---

# API04003: Respuesta JSON Mal Formada

## Qué Significa

El servidor devolvió datos que parecen ser JSON pero están corruptos o no son válidos. El POS no pudo analizar la respuesta porque la sintaxis JSON está rota.

## Causas Comunes

- **Avisos/advertencias de PHP** — Salida de PHP antes del JSON
- **BOM (Marca de Orden de Bytes)** — Caracteres invisibles al inicio del archivo
- **Problemas de codificación** — Problemas de codificación de caracteres
- **Respuesta truncada** — Respuesta cortada durante la transmisión
- **Salida de plugin** — Un plugin agregó contenido no JSON

## Cómo Solucionarlo

### 1. Verificar Avisos de PHP

Los avisos/advertencias de PHP antes del JSON rompen el análisis:

En `wp-config.php`:
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

Revise `wp-content/debug.log` y corrija cualquier problema.

### 2. Verificar Caracteres BOM

Algunos editores de texto añaden caracteres BOM invisibles:
- Vuelva a guardar archivos PHP sin BOM
- Use codificación UTF-8 sin BOM
- Verifique archivos editados recientemente

### 3. Verificar Respuesta Completa

Si las respuestas se están truncando:
- Verifique la configuración de buffer de salida de PHP
- Aumente `output_buffering` en php.ini
- Compruebe problemas de tiempo de espera

### 4. Probar API Directamente

En su navegador o usando curl:
```bash
curl -v https://sutienda.com/wp-json/wcpos/v1/
```

Busque cualquier contenido inesperado antes del JSON.

### 5. Verificar Codificación de Caracteres

Asegúrese de que la base de datos y PHP usen UTF-8:
- Compruebe la configuración de juego de caracteres en `wp-config.php`
- Verifique que las tablas de la base de datos sean UTF-8
- Busque caracteres especiales que causen problemas

## Errores Relacionados

- [API04001](./API04001) — Formato de Respuesta Inválido
- [API04005](./API04005) — Recuperación de JSON Intentada