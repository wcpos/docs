---
title: チェックアウトパフォーマンス
sidebar_label: チェックアウトパフォーマンス
sidebar_position: 1
description: 実行時間を分析しボトルネックを特定することで、WCPOSの遅いチェックアウト時間をトラブルシューティングします。
---

import Image from "@theme/IdealImage";
import LinkCards from '@site/src/components/LinkCards';
import LinkCard from '@site/src/components/LinkCard';

チェックアウトプロセス中にパフォーマンスが遅い場合、このガイドは最も一般的な原因を特定し解決する手助けをします。

## WCPOSチェックアウトの仕組み {#how-wcpos-checkout-works}

WCPOSのチェックアウトは、WooCommerceの注文支払いテンプレートの簡略版を読み込むiframe/webviewを持つモーダルを開きます。これは、顧客がオンラインで注文を支払う際に見る[顧客支払いページ](https://woocommerce.com/document/managing-orders/paying-for-orders/#customer-payment-page-link)と本質的に同じページです。

:::info 開発者ノート
WCPOSプラグインリポジトリでチェックアウトテンプレートを表示できます: [templates/payment.php](https://github.com/wcpos/woocommerce-pos/blob/main/templates/payment.php)
:::

## 組み込み最適化 {#built-in-optimizations}

WCPOSには、チェックアウトパフォーマンスを向上させるためのいくつかの最適化が含まれています。

- **簡略化されたテンプレート** - 不要なテーマ要素と混乱を削除
- **選択的なスクリプト/スタイルの読み込み** - 必要なスクリプトとスタイルのみが読み込まれる
- **最小限のDOM構造** - チェックアウトページの複雑さを削減

ただし、一部のスクリプトとスタイルは完全に無効にできません。支払いゲートウェイが正常に機能するために必要とされる場合があります。

## 一般的なパフォーマンスの問題 {#common-performance-issues}

### 1. 不要なスクリプトとスタイル {#1-unnecessary-scripts-and-styles}

**問題:** テーマやプラグインがチェックアウトに必要ないスクリプトやスタイルを追加し、ページの読み込み時間を遅くします。

**解決策:** [チェックアウト設定](/pos/checkout#checkout-settings-troubleshooting)を使用して不要なリソースを無効にします。

1. チェックアウトモーダル内の**チェックアウト設定**ボタンをクリック
2. まずテーマスタイルを無効にしてみてください:
   - wp-block-library
   - classic-theme-styles
   - あなたのテーマのカスタムスタイル
3. 非必須のWooCommerceスクリプトを無効にします:
   - wc-add-to-cart
   - selectWoo（ゲートウェイに必要ない場合）
   - html5shiv

<div class="image-container">
  <Image
    alt="すべてのスタイルとスクリプトを無効にするためのフォーム"
    img="/img/disable-styles-and-scripts.png"
    style={{ maxHeight: 600 }}
  />
  <p class="image-caption">すべてのスタイルとスクリプトを無効にするためのフォーム</p>
</div>

:::warning 注意
支払いゲートウェイが必要とするスクリプトを無効にしないでください。スクリプトを無効にした後に支払い方法が機能しなくなった場合は、再度有効にしてください。
:::

### 2. 注文作成中のプラグイン干渉 {#2-plugin-interference-during-order-creation}

**問題:** 注文作成プロセスにフックするプラグインは、重大な遅延を引き起こす可能性があります。例えば、Xeroのような会計プラグインは、注文データを外部サーバーに送信し、チェックアウトプロセスをブロックする場合があります。

**トラブルシューティング手順:**

1. **ステージングでテスト** - ステージングサーバーがある場合、WooCommerceとWCPOS以外のすべてのプラグインを無効にします
2. **チェックアウト速度をテスト** - テスト注文を処理し、パフォーマンスを記録します
3. **プラグインを徐々に有効にする** - パフォーマンスが大幅に改善された場合、問題のプラグインを1つずつ再有効化します
4. **プラグイン開発者に連絡** - 特定のプラグインが問題を引き起こしている場合、最適化のアドバイスを求めます

**一般的な問題のあるプラグインタイプ:**
- 会計/簿記統合（Xero、QuickBooks）
- 注文作成時にトリガーされるメールマーケティングツール
- 在庫管理システム
- 複雑な配送計算機
- サードパーティの分析ツール

### 3. サーバーリソースの制限 {#3-server-resource-limitations}

**問題:** サーバーが負荷にさらされているか、十分なリソースがない場合は、チェックアウトを含むすべての操作が遅くなります。

**監視と解決策:**

1. **サーバーパフォーマンスを監視する:**
   - チェックアウト中のCPU使用率
   - メモリ消費
   - データベースクエリのパフォーマンス
   - ネットワークレイテンシ

2. **サーバーリソースを最適化:**
   - PHPメモリ制限を増加させる
   - データベースクエリを最適化する
   - キャッシングプラグインを使用する（が、互換性をテスト）
   - ホスティングプランのアップグレードを検討する

3. **データベースの最適化:**
   - 古い注文データをクリーンアップする
   - データベーステーブルを最適化する
   - 不要なプラグインとテーマを削除する

## WordPress開発者のベストプラクティス {#wordpress-developer-best-practices}

:::tip 開発者向け
WordPress開発者は、`wp_enqueue_scripts`を使用して、ページにスクリプトとスタイルを適切に追加すべきです。残念ながら、一部のプラグインやテーマの開発者はベストプラクティスに従わず、テンプレートにコードを直接挿入し、これらのリソースを容易に非表示にすることができなくなります。
:::

チェックアウト設定を通じて無効にできないスクリプトやスタイルに問題がある場合:

1. **開発者に連絡する** - WordPressのコーディングスタンダードに従うよう依頼します
2. **子テーマを使用する** - 子テーマ内で問題のあるテンプレートを上書きします
3. **カスタムフック** - WordPressフックを使用して、チェックアウトページ上の問題のあるコードを削除します

## パフォーマンステスト {#performance-testing}

チェックアウトパフォーマンスの改善をテストするには:

1. **ベースライン測定** - 変更を加える前にチェックアウトにかかる時間を計ります
2. **一度に1つの変更を加える** - どの変更が最も影響を与えるかを特定するのに役立ちます
3. **実際の支払いゲートウェイでテスト** - 現金支払いだけでテストしないでください
4. **異なるデバイスでテスト** - モバイルデバイスは異なるパフォーマンス特性を示す可能性があります

## 短期的な改善 {#quick-wins}

次のパフォーマンス改善が最も効果的です。

1. **テーマスタイルを無効にする** - しばしば最も大きな改善を提供します
2. **不要なWooCommerceスクリプトを削除する** - JavaScript実行時間を短縮します
3. **注文作成フックを監査する** - 遅いプラグインを特定し最適化します
4. **画像を最適化する** - チェックアウト内の画像が最適化されていることを確認します
5. **パフォーマンス監視プラグインを使用する** - 時間の経過と共に改善を追跡します

## 助けを求めるべき時 {#when-to-seek-help}

次の場合はWCPOSサポートに連絡してください。

- チェックアウトが常に10秒以上かかる
- このガイドに従ったが、まだ問題が発生している
- 特定のプラグインを疑っているが、特定できない
- サーバーリソースの最適化に助けが必要

## 関連ドキュメント {#related-documentation}

<LinkCards>
  <LinkCard to="/pos/checkout#checkout-settings-troubleshooting" title="チェックアウト設定" description="問題のあるスクリプトとスタイルを無効にする" />
  <LinkCard to="/payment" title="支払い方法" description="最適なパフォーマンスのために支払いゲートウェイを設定する" />
  <LinkCard to="/category/troubleshooting" title="トラブルシューティング" description="一般的なトラブルシューティングガイド" />
</LinkCards>