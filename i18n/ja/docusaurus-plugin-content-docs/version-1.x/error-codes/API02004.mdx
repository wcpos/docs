---
title: "API02004: ユーザー認証不可"
sidebar_label: API02004
---

# API02004: ユーザー認証不可

## この意味

ログイン済みですが、リクエストされたアクションを実行する権限がユーザーアカウントにありません。これは認証（誰であるか）の問題ではなく、認可（何ができるか）の問題です。

## 一般的な原因

- **ユーザーロールの制限** — WordPressロールにPOSアクセス権がない
- **POSアクセスの無効化** — アカウントにPOS権限が付与されていない
- **機能の制限** — 特定の機能が特定のロールに限定されている
- **店舗の制限** — 特定の店舗にアクセスできない

## サーバーエラーマッピング

このエラーコードは、サーバーが以下を返す場合にトリガーされます：

| サーバーコード | ソース |
|-------------|--------|
| `rest_cannot_view` | WordPress REST API |
| `woocommerce_rest_cannot_view` | WooCommerce REST API |

## 修正方法

### 1. ユーザーロールの確認

WordPress管理画面 → ユーザー:
1. ユーザーアカウントを探す
2. ロールを確認（例：ショップマネージャー、管理者）
3. ロールにWooCommerceの権限が含まれていることを確認

### 2. POSアクセスの有効化

WordPress管理画面 → WooCommerce → POS → アクセス:
1. ユーザーまたはロールを探す
2. POS権限を有効化
3. 変更を保存

### 3. 追加権限のリクエスト

店舗管理者に以下を依頼:
- ロールにPOSアクセス権を付与
- 適切な権限を持つロールを割り当て
- 必要な機能を有効化

### 4. 店舗の割り当てを確認

複数店舗を使用している場合:
- 正しい店舗に割り当てられていることを確認
- 店舗固有の権限を確認

## 必要な権限

異なるアクションには異なる権限が必要:
- **商品の表示**: 商品の読み取りアクセス
- **注文の作成**: 注文の作成/編集権限
- **顧客の管理**: 顧客管理権限
- **レポートへのアクセス**: レポート表示権限

## 関連エラー

- [API02005](./API02005) — 権限不足
- [API02001](./API02001) — 無効な認証情報