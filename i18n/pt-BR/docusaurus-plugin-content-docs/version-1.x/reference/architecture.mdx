---
title: Arquitetura
sidebar_label: Arquitetura
sidebar_position: 2
---

import LocalizedSVG from '@site/src/components/LocalizedSVG';

Esta p√°gina explica a arquitetura t√©cnica do WCPOS para desenvolvedores e usu√°rios avan√ßados.

## Sistema em Duas Partes

O WCPOS √© projetado como um sistema em duas partes:

1. **Plugin PHP:** Hospedado em seu servidor, este √© um plugin relativamente pequeno que estende a [API REST do WooCommerce](/reference/wc-rest-api).

2. **Cliente JavaScript:** Este √© executado localmente em seu navegador ou no aplicativo desktop, e posteriormente em aplicativos iOS e Android.

Voc√™ pode pensar nisso como dois mundos separados:

- O _mundo PHP_ √© onde a gest√£o de dados acontece usando WordPress e WooCommerce.
- O _mundo JavaScript_ replica sua loja WooCommerce localmente, otimizado para buscas r√°pidas e uso offline.

<LocalizedSVG svgName="pos-client-woo-server" />

## Sincroniza√ß√£o de Dados

Os dados s√£o buscados do WooCommerce usando a [API REST do WooCommerce](https://woocommerce.github.io/woocommerce-rest-api-docs/). Isso significa que o POS precisa baixar cada produto, varia√ß√£o, categoria de produto, cliente, taxa de imposto e mais para armazen√°-los localmente.

Embora isso possa levar algum tempo inicialmente, uma vez baixados, eles est√£o dispon√≠veis instantaneamente sem a necessidade de busc√°-los continuamente do servidor.

### O Que √© Sincronizado?

- Produtos e varia√ß√µes
- Categorias e tags de produtos
- Clientes
- Taxas de imposto e classes de imposto
- Gateways de pagamento (para checkout)
- Pedidos (para hist√≥rico de pedidos no Pro)

### Estrat√©gia de Sincroniza√ß√£o

O WCPOS utiliza uma estrat√©gia de sincroniza√ß√£o incremental:

1. **Sincroniza√ß√£o inicial:** Baixa todos os dados na primeira carga
2. **Atualiza√ß√µes incrementais:** Apenas busca as altera√ß√µes desde a √∫ltima sincroniza√ß√£o
3. **Sincroniza√ß√£o em segundo plano:** Verifica periodicamente se h√° atualiza√ß√µes
4. **Sincroniza√ß√£o manual:** O usu√°rio pode acionar uma sincroniza√ß√£o a qualquer momento

## Pr√≥s e Contras da Arquitetura

| Bom üòä | Ruim üòü |
| ------------------------------------------------------------------ | -------------------------------------------------------- |
| Busca de dados locais √© instant√¢nea | Manter os dados sincronizados √© desafiador |
| Dados em cache dispon√≠veis offline | Limitado pela API REST do WooCommerce |
| Capacidade de criar melhores aplicativos nativos para desktop, iOS e Android | Temas e hooks do WordPress n√£o podem personalizar o aplicativo POS |

## Banco de Dados Local

O cliente JavaScript armazena dados no IndexedDB, um banco de dados baseado em navegador. Isso fornece:

- **Persist√™ncia:** Os dados sobrevivem a rein√≠cios do navegador
- **Desempenho:** Consultas r√°pidas sem lat√™ncia de rede
- **Navega√ß√£o offline:** Dados em cache permanecem acess√≠veis sem internet

## Arquitetura de Checkout

O processo de checkout utiliza um iframe/webview que carrega a p√°gina de Pagamento do Pedido do WooCommerce. Esta abordagem:

- **Aproveita gateways de pagamento existentes:** Qualquer gateway de pagamento do WooCommerce pode funcionar no POS
- **Mant√©m a seguran√ßa:** O processamento de pagamento ocorre pela infraestrutura segura do WooCommerce
- **Reduz a complexidade:** N√£o h√° necessidade de reimplementa√ß√£o das integra√ß√µes de gateway de pagamento

## Extens√µes de API

O plugin PHP estende a API REST do WooCommerce com endpoints adicionais para funcionalidade espec√≠fica do POS. Veja a [API REST do WooCommerce](/reference/wc-rest-api) para detalhes.

---