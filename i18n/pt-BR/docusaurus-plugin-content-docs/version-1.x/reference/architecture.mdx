---
title: Arquitetura
sidebar_label: Arquitetura
sidebar_position: 2
---

import LocalizedSVG from '@site/src/components/LocalizedSVG';

Esta p√°gina explica a arquitetura t√©cnica do WCPOS para desenvolvedores e usu√°rios avan√ßados.

## Sistema Bipartido

O WCPOS √© projetado como um sistema bipartido:

1. **Plugin PHP:** Hospedado em seu servidor, este √© um plugin relativamente pequeno que estende a [API REST do WooCommerce](/reference/wc-rest-api).

2. **Cliente JavaScript:** Executado localmente no seu navegador ou no aplicativo desktop, e posteriormente nos aplicativos iOS e Android.

Voc√™ pode pensar como dois mundos separados:

- O _mundo PHP_ √© onde a gest√£o de dados acontece usando WordPress e WooCommerce.
- O _mundo JavaScript_ replica sua loja WooCommerce localmente, otimizado para busca r√°pida e uso offline.

<LocalizedSVG svgName="pos-client-woo-server" />

## Sincroniza√ß√£o de Dados

Os dados s√£o obtidos do WooCommerce usando a [API REST do WooCommerce](https://woocommerce.github.io/woocommerce-rest-api-docs/). Isso significa que o POS precisa baixar todos os produtos, varia√ß√µes, categorias de produtos, clientes, taxas de imposto e mais para armazen√°-los localmente.

Embora isso possa ser demorado inicialmente, uma vez baixados, est√£o dispon√≠veis instantaneamente sem a necessidade de buscar continuamente no servidor.

### O Que √â Sincronizado?

- Produtos e varia√ß√µes
- Categorias e tags de produtos
- Clientes
- Taxas de imposto e classes de imposto
- Meios de pagamento (para checkout)
- Pedidos (para hist√≥rico de pedidos no Pro)

### Estrat√©gia de Sincroniza√ß√£o

O WCPOS usa uma estrat√©gia de sincroniza√ß√£o incremental:

1. **Sincroniza√ß√£o inicial:** Baixa todos os dados no primeiro carregamento
2. **Atualiza√ß√µes incrementais:** Busca apenas as altera√ß√µes desde a √∫ltima sincroniza√ß√£o
3. **Sincroniza√ß√£o em segundo plano:** Verifica periodicamente por atualiza√ß√µes
4. **Sincroniza√ß√£o manual:** Usu√°rio pode disparar uma sincroniza√ß√£o a qualquer momento

## Pr√≥s e Contras da Arquitetura

| Bom üòä | Ruim üòü |
| ------------------------------------------------------------------ | -------------------------------------------------------- |
| Busca em dados locais √© instant√¢nea | Manter dados sincronizados √© desafiador |
| Dados em cache dispon√≠veis offline | Limitado pela API REST do WooCommerce |
| Capacidade de criar aplicativos nativos melhores para desktop, iOS e Android | Temas WordPress e hooks n√£o podem personalizar o aplicativo POS |

## Banco de Dados Local

O cliente JavaScript armazena dados no IndexedDB, um banco de dados baseado em navegador. Isso fornece:

- **Persist√™ncia:** Dados sobrevivem a rein√≠cios do navegador
- **Desempenho:** Consultas r√°pidas sem lat√™ncia de rede
- **Navega√ß√£o offline:** Dados em cache permanecem acess√≠veis sem internet

## Arquitetura de Checkout

O processo de checkout usa um iframe/webview que carrega a p√°gina de Pagamento de Pedido do WooCommerce. Esta abordagem:

- **Aproveita meios de pagamento existentes:** Qualquer meio de pagamento do WooCommerce pode funcionar no POS
- **Mant√©m seguran√ßa:** Processamento de pagamento acontece atrav√©s da infraestrutura segura do WooCommerce
- **Reduz complexidade:** Sem necessidade de reimplementar integra√ß√µes de meios de pagamento

## Extens√µes de API

O plugin PHP estende a API REST do WooCommerce com endpoints adicionais para funcionalidade espec√≠fica do POS. Consulte [API REST do WooCommerce](/reference/wc-rest-api) para detalhes.