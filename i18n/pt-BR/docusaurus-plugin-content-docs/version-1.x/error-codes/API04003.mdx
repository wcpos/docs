---
title: "API04003: Resposta JSON Malformada"
sidebar_label: API04003
---

# API04003: Resposta JSON Malformada

## O Que Isso Significa

O servidor retornou dados que parecem ser JSON, mas estão corrompidos ou inválidos. O POS não conseguiu analisar a resposta porque a sintaxe JSON está quebrada.

## Causas Comuns

- **Avisos/alertas PHP** — Saída PHP antes do JSON
- **BOM (Byte Order Mark)** — Caracteres invisíveis no início do arquivo
- **Problemas de codificação** — Problemas de codificação de caracteres
- **Resposta truncada** — Resposta cortada no meio da transmissão
- **Saída de plugin** — Um plugin adicionou conteúdo não-JSON

## Como Corrigir

### 1. Verificar Avisos PHP

Avisos/alertas PHP antes do JSON quebram a análise:

Em `wp-config.php`:
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

Revise `wp-content/debug.log` e corrija quaisquer problemas.

### 2. Verificar Caracteres BOM

Alguns editores de texto adicionam caracteres BOM invisíveis:
- Salve novamente os arquivos PHP sem BOM
- Use codificação UTF-8 sem BOM
- Verifique arquivos editados recentemente

### 3. Verificar Resposta Completa

Se as respostas estiverem sendo truncadas:
- Verifique as configurações de buffer de saída PHP
- Aumente `output_buffering` no php.ini
- Verifique problemas de tempo limite

### 4. Testar API Diretamente

No navegador ou usando curl:
```bash
curl -v https://seusite.com/wp-json/wcpos/v1/
```

Procure por qualquer conteúdo inesperado antes do JSON.

### 5. Verificar Codificação de Caracteres

Garanta que banco de dados e PHP usem UTF-8:
- Verifique configurações de conjunto de caracteres em `wp-config.php`
- Confirme que as tabelas do banco de dados estão em UTF-8
- Procure por caracteres especiais causando problemas

## Erros Relacionados

- [API04001](./API04001) — Formato de Resposta Inválido
- [API04005](./API04005) — Tentativa de Recuperação de JSON