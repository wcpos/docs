---
description: WCPOS Documentation site context
globs:
alwaysApply: true
---

# WCPOS Documentation

## What This Is

Public documentation website for WCPOS, built with Docusaurus 2.

- **URL**: https://docs.wcpos.com (or similar)
- **Framework**: Docusaurus 2
- **Package Manager**: pnpm

## System Context

This is a standalone documentation site. For backend infrastructure, see `wcpos-infra/ARCHITECTURE.md`.

## Development

```bash
pnpm install
pnpm start                # Dev server (port 3000)
pnpm start --port 3001    # Dev server on specific port (for testing changes)
pnpm build                # Production build (slow - use sparingly)
```

**Testing Changes:**
- Use `pnpm start --port XXXX` for quick testing instead of full builds
- Full builds take 2-3 minutes and should only be run before committing
- Dev server hot-reloads most changes instantly

## Structure

```
docs/
├── docs/           # Documentation pages (MDX)
├── blog/           # Blog posts
├── src/            # React components
├── static/         # Static assets
├── docusaurus.config.js
└── sidebars.js
```

## Writing Docs

- Use MDX format (Markdown + JSX)
- Front matter for metadata
- Sidebars configured in `sidebars.js`

### Sidebar Updates (IMPORTANT)

**When adding new pages to versioned docs, you MUST manually update the versioned sidebar:**

- `versioned_sidebars/version-1.x-sidebars.json` - For version 1.x docs
- `versioned_sidebars/version-0.4.x-sidebars.json` - For version 0.4.x docs

The versioned sidebars are NOT auto-generated. New pages will not appear in navigation until added to the appropriate sidebar JSON file.

```json
// Example: Adding a new page to Products section
"items": [
  "products/pos-only-products",  // Add new page ID here
  "products/sync"
]
```

### Custom Components (IMPORTANT)

Use reusable components to maintain visual consistency and enable future style changes without updating all translations.

**Available Components (`src/components/`):**

| Component | Purpose | Default Title |
|-----------|---------|---------------|
| `Accordion` + `AccordionItem` | Collapsible FAQ/troubleshooting | "Troubleshooting" |
| `LinkCards` + `LinkCard` | Related documentation links | "Related Documentation" |
| `Steps` + `StepCard` | Sequential instructions (installation, setup) | (none) |
| `FeatureGrid` + `FeatureCard` | Feature lists with icons | (none) |
| `UseCases` + `UseCaseCard` | Use case descriptions with icons | "Use Cases" |
| `PlatformBadges` + `PlatformBadge` | Platform availability indicators | (none) |

**Root components with default titles:**
```jsx
// Default title "Troubleshooting"
<Accordion>...</Accordion>

// Override title for FAQs
<Accordion title="F.A.Q.">...</Accordion>

// Default title "Related Documentation"
<LinkCards>...</LinkCards>

// Override title for navigation
<LinkCards title="Next Steps">...</LinkCards>

// No title
<Accordion title={null}>...</Accordion>
```

**Component Architecture Rules:**

1. **Always use Root wrappers** - When creating new components, always include a Root/Container component. This enables global style changes without updating content files.
   ```jsx
   // ✅ Correct - Root wrapper for style control
   <FeatureGrid>
     <FeatureCard ... />
     <FeatureCard ... />
   </FeatureGrid>
   
   // ❌ Wrong - No wrapper, harder to restyle
   <FeatureCard ... />
   <FeatureCard ... />
   ```

2. **Identify repeated patterns** - When you see the same content structure repeated across docs (bullet lists, step-by-step instructions, FAQ sections), create a component for it.

3. **Keep content in MDX** - Components should accept children/props for content. Don't hardcode text in components—this breaks translations.

4. **Use CSS custom properties** - All component styles should use Infima CSS variables for dark mode compatibility.

**When to create new components:**
- Same visual pattern appears 3+ times across documentation
- Content structure is identical but text differs
- You want to change the look/feel globally in the future

### Swizzling Docusaurus Theme Components (CRITICAL)

To customise built-in Docusaurus components (like DocCard, DocCardList), you MUST use the official swizzle command:

```bash
# Eject a component for full control
npx docusaurus swizzle @docusaurus/theme-classic DocCard --eject --danger

# This creates files in src/theme/DocCard/ that override the default
```

**NEVER try to:**
1. ❌ Copy component code manually from node_modules
2. ❌ Import from `@docusaurus/plugin-content-docs/client` in custom components (won't resolve)
3. ❌ Import from `@docusaurus/theme-common` in custom components (won't resolve)
4. ❌ Style DocCardList with CSS-only approaches (too complex, high specificity)

**The correct approach:**
1. ✅ Use `npx docusaurus swizzle ... --eject --danger` to get the component
2. ✅ Add required dependencies explicitly: `pnpm add @docusaurus/plugin-content-docs @docusaurus/theme-common`
3. ✅ Modify the ejected component in `src/theme/`
4. ✅ Test with `pnpm start --port 3001` before committing

**Why swizzle works but manual copying doesn't:**
- Docusaurus sets up webpack aliases during build that resolve internal imports
- These aliases only work for files created by the swizzle command
- The swizzle command also handles TypeScript types and CSS modules correctly

**Currently swizzled components (`src/theme/`):**
- `DocCard/` - Uses our Icon component and link-card styling
- `DocCardList/` - Adds "In This Section" title, uses link-cards grid

### Icons and UI Elements

**ALWAYS use the Icon component for FontAwesome icons:**

```jsx
import Icon from '@site/src/components/Icon';

// ✅ Correct - Use Icon component
<Icon name="arrow-rotate-right" />
<Icon name="sliders" />
<Icon name="circle-plus" color="green" />

// ❌ Wrong - Don't use Unicode symbols
(↻) (⚙️) (➕)
```

**Common icon names:**
- `arrow-rotate-right` - Sync/refresh button
- `sliders` - Settings/display options
- `circle-plus` - Add to cart
- `circle-arrow-right` - Variable product selection
- `ellipsis-vertical` - Three-dot menu (⋮)

**When documenting UI elements:**
- Always import Icon component at the top of MDX files
- Use semantic icon names from FontAwesome
- Include color prop when the UI element has specific colors
- Be consistent with icon usage across all documentation

## Docusaurus Link Structure

**IMPORTANT:** Docusaurus generates different URL structures for categories vs documents.

| Type | Sidebar Config | URL Pattern | Example |
|------|----------------|-------------|---------|
| Category | `"link": {"type": "generated-index"}` | `/category/[name]` | `/category/troubleshooting` |
| Document | Individual doc reference | `/[section]/[doc]` | `/support/troubleshooting/critical-error` |

**When linking in documentation:**
- ✅ `[Troubleshooting](/category/troubleshooting)` - Links to category index
- ❌ `[Troubleshooting](/support/troubleshooting)` - This URL doesn't exist

Always check `sidebars.js` to understand how URLs are generated.

## Content Guidelines

### Performance Documentation
- Emphasise **execution times over server load values** for performance assessment
- Highlight **WooCommerce HPOS** as the primary performance improvement
- Only include universally acknowledged WordPress best practices
- Link to official WooCommerce documentation for HPOS

### Troubleshooting Documentation
- Always emphasise using **staging sites** for testing
- Follow systematic plugin elimination methodology
- Cross-reference with existing error codes and logs documentation

### Links and Cross-References
- Use relative links within the documentation (e.g., `/support/logs`)
- Always verify link targets exist before committing
- Use category links (`/category/[name]`) for generated index pages
- Use document links (`/section/document`) for specific pages

## UK English

All documentation must use British English spelling:

- colour (not color)
- organisation (not organization)
- behaviour (not behavior)
- centre (not center) - except in CSS code
- catalogue (not catalog)
- customise (not customize)
- optimise (not optimize)
- localise (not localize)
- authorise (not authorize)
- analyse (not analyze)
- realise (not realize)
- licence (noun) / license (verb)
- grey (not gray)
- dialogue (not dialog) - except in code/UI references
- -ise endings preferred (organise, recognise, etc.)

**Exceptions:**
- CSS properties (e.g., `text-align: center`)
- WooCommerce UI labels if they use US spelling
- Proper nouns (e.g., Authorize.net)

## Common Mistakes to Avoid

1. **Don't assume URL structure** - Check `sidebars.js` to understand how Docusaurus generates URLs
2. **Don't use American spelling** - Always use British English
3. **Don't include unverified database advice** - Stick to universally acknowledged WordPress best practices
4. **Don't misinterpret server load values** - High load doesn't always mean poor performance
5. **Don't forget to update sidebar navigation** when adding new documents (especially versioned sidebars!)
6. **Don't use Unicode symbols for icons** - Always use the `<Icon name="..." />` component instead of (↻), (⚙️), etc.
7. **Don't manually copy Docusaurus theme components** - Use `npx docusaurus swizzle` instead
8. **Don't import internal Docusaurus modules in custom components** - They won't resolve outside of swizzled theme components
9. **Don't run full builds for testing** - Use `pnpm start --port XXXX` for quick iteration
10. **Don't style complex Docusaurus components with CSS-only** - Swizzle them for full control

## Related Projects

- `monorepo-v2` - The main WCPOS app these docs describe
- `woocommerce-pos` - The WordPress plugin these docs describe
